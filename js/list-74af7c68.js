import{q as y,x as i,J as h,al as w,a2 as b,O as j,v as x,R as P,L as k,aB as C,K as R}from"./app-976c8860.js";import{D as B}from"./delete-confirm-dc2118f8.js";import{R as D}from"./relative-time-d8a79e8f.js";import{u as E}from"./use-table-25e379fb.js";import"./guard-eb7806bc.js";import{r as F}from"./use-store-ref-4b184b85.js";import{H as S}from"./rounded-button-b9dcbed0.js";import{a as U}from"./Checkbox-68906a54.js";import{N as q,a as A}from"./Pagination-6e2c7787.js";import{k as M,B as T,at as z,R as I,U as e,F as L,aO as n,aH as O,br as u,bq as V}from"./Button-b701b7aa.js";import{N as H,a as K}from"./Spin-6ba2d125.js";import{N as _,a as G}from"./ListItem-4fb59faf.js";import{N as J}from"./ButtonGroup-ded3106c.js";import{N as d}from"./Avatar-61c996be.js";import"./preload-helper-f651ca80.js";import"./Card-6ffecc90.js";import"./light-8f5c5466.js";import"./Select-a2a95bdb.js";import"./light-a088cd9f.js";import"./Tag-0091d0ba.js";import"./_common-991711fd.js";import"./Forward-3a0b079d.js";import"./light-8efb1dbb.js";import"./prop-8b8caa29.js";import"./light-81ba7871.js";import"./utils-077c54a7.js";import"./light-6661c722.js";function Q(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Object]"&&!V(o)}const xe=M({setup(){const{data:o,pager:s,sortProps:W,fetchDataFn:m,loading:f}=E((a,t)=>async(N=p.query.page||1,v=30)=>{const c=await i.api.projects.get({params:{page:N,size:v}});a.value=c.data,t.value=c.pagination}),r=T(new Set),g=y(),p=F(),l=m;return z(()=>p.query.page,async a=>{await l(a)}),I(async()=>{await l()}),()=>e(R,null,{actions:()=>e(L,null,[e(B,{checkedRowKeys:r,onDelete:async()=>{await Promise.all(Array.from(r.values()).map(a=>i.api.projects(a).delete())),r.clear(),l()}},null),e(S,{to:"/projects/edit",icon:e(h,null,null)},null)]),default:()=>e(H,{show:f.value},{default:()=>[e(_,{bordered:!1,class:"min-h-[300px] bg-transparent"},{footer(){return e("div",{class:"flex justify-end"},[e(q,{itemCount:s.value.total,pageCount:s.value.totalPage,page:s.value.currentPage,pageSize:s.value.size,onUpdatePage:a=>{l(a)}},null)])},default(){return o.value.map(a=>e(G,{key:a.id},{prefix(){return e(U,{class:"mt-4",checked:r.has(a.id),onUpdateChecked:t=>{t?r.add(a.id):r.delete(a.id)}},null)},default(){return e(w,{description:a.description},{header(){return e("div",null,[e(n,O({ghost:!0,type:"primary",text:!0,class:"!font-medium"},a.projectUrl?{tag:"a",href:a.projectUrl,target:"_blank"}:{}),{default:()=>[a.name]})])},footer(){return e(b,null,{default:()=>[e(K,{class:"pl-[3.6rem] text-[var(--clear-color-pressed)] text-sm"},{default:()=>[e("span",null,[u("创建于 "),j(a.created)]),a.modified&&e("span",null,[u("更新于")," ",e(D,{time:a.modified},null)])]})]})},"header-extra":function(){return e(J,null,{default:()=>[e(n,{onClick:()=>{x.push({name:P.EditProject,query:{id:a.id}})}},{default:()=>[u("编辑")]}),e(A,{class:"!p-0",options:[{value:"del",label:"",render(){return e(n,{type:"error",bordered:!1,onClick:async()=>{await i.api.projects(a.id).delete(),g.success("删除成功"),await l(s.value.currentPage)}},{default:()=>[u("删除")]})}}]},{default:()=>[e(n,{class:"!px-2"},{default:()=>[e(k,null,{default:()=>[e(C,null,null)]})]})]})]})},avatar(){let t;return a.avatar?e(d,{class:"align-center",circle:!0,src:a.avatar,size:"large"},null):e(d,{circle:!0,size:"large",class:"align-center"},Q(t=a.name[0].toUpperCase())?t:{default:()=>[t]})}})}}))}})]})})}});export{xe as default};
