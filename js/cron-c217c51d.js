import{T as c}from"./index-2c962807.js";import{u as d}from"./use-table-17c69ba1.js";import{aj as f,J as y,y as i,b4 as h}from"./app-c79d7097.js";import{d as g,o as T,b as o,Z as s}from"./create-injection-key-6dff4bbb.js";import{b as x}from"./p-d5bd0779.js";import{N as b}from"./Popconfirm-8705d822.js";import{Z as k}from"./Card-720de80b.js";import"./use-store-ref-10b7967e.js";import"./DataTable-ee8322e1.js";import"./fade-in.cssr-c6d077ce.js";import"./ChevronRight-d32dd5c3.js";import"./Checkbox-130849a4.js";import"./light-4a540c7a.js";import"./light-dcf71249.js";import"./light-758cc2d5.js";import"./light-b93dede2.js";import"./light-806b66fd.js";import"./Select-a912f9f4.js";import"./Tag-945120fa.js";import"./_common-991711fd.js";import"./Pagination-b72c8488.js";import"./Forward-d74203eb.js";import"./prop-8b8caa29.js";import"./Tooltip-e8ef26b6.js";import"./preload-helper-f651ca80.js";import"./light-432a397e.js";const I=g({setup(){const{data:n,fetchDataFn:m,loading:l}=d(t=>async()=>{const a=await i.api.health.cron.get();t.value=Array.from(Object.values(a.data).map(e=>({...e,_name:e.name,name:h(e.name)})))});T(async()=>{await m()});const u=async(t,a)=>{await i.api.health.cron.run(t).post();let e=setTimeout(function p(){i.api.health.cron.task(t).get().then(r=>{r.status==="fulfill"?(message.success(`${a} 执行完成`),e=clearTimeout(e)):r.status==="reject"?(message.error(`${a} 执行失败, ${r.message}`),e=clearTimeout(e)):e=setTimeout(p,1e3)})},1e3)};return()=>o(y,null,{default:()=>[o(c,{noPagination:!0,data:n,loading:l.value,nTableProps:{maxHeight:"calc(100vh - 17rem)"},maxWidth:500,columns:[{title:"任务",key:"name",ellipsis:{tooltip:!0},width:150},{title:"描述",key:"description",width:250,ellipsis:{tooltip:!0}},{title:"状态",key:"status"},{title:"下次执行",key:"",render(t){const a=t.nextDate;return a?f(new Date(a),"MM/dd/yyyy hh:mm:ss"):"N/A"}},{title:"操作",key:"",render(t){return o(x,null,{default:()=>[o(b,{onPositiveClick:()=>void u(t._name,t.name)},{trigger(){return o(k,{size:"tiny",text:!0,type:"success"},{default:()=>[s("执行")]})},default:()=>o("span",{class:"max-w-48"},[s("确定要执行?")])})]})}}]},null)]})}});export{I as default};
