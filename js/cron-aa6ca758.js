import{T as c}from"./index-019f837c.js";import{u as d}from"./use-table-25e379fb.js";import{ah as f,K as h,x as i,a_ as y}from"./app-976c8860.js";import{k as g,R as x,U as r,aO as T,br as s}from"./Button-b701b7aa.js";import{a as k}from"./Spin-6ba2d125.js";import{N as C}from"./Popconfirm-ef910421.js";import"./use-store-ref-4b184b85.js";import"./DataTable-fbbadfbc.js";import"./ChevronRight-0f5b6e50.js";import"./Checkbox-68906a54.js";import"./light-8f5c5466.js";import"./light-8b77b0de.js";import"./light-8efb1dbb.js";import"./light-a088cd9f.js";import"./light-a589b0af.js";import"./Card-6ffecc90.js";import"./Select-a2a95bdb.js";import"./Tag-0091d0ba.js";import"./_common-991711fd.js";import"./Pagination-6e2c7787.js";import"./Forward-3a0b079d.js";import"./prop-8b8caa29.js";import"./Tooltip-b62453d8.js";import"./preload-helper-f651ca80.js";import"./light-630c8175.js";const G=g({setup(){const{data:n,fetchDataFn:m,loading:u}=d(t=>async()=>{const a=await i.api.health.cron.get();t.value=Array.from(Object.values(a.data).map(e=>({...e,_name:e.name,name:y(e.name)})))});x(async()=>{await m()});const l=async(t,a)=>{await i.api.health.cron.run(t).post();let e=setTimeout(function p(){i.api.health.cron.task(t).get().then(o=>{o.status==="fulfill"?(message.success(`${a} 执行完成`),e=clearTimeout(e)):o.status==="reject"?(message.error(`${a} 执行失败，${o.message}`),e=clearTimeout(e)):e=setTimeout(p,1e3)})},1e3)};return()=>r(h,null,{default:()=>[r(c,{noPagination:!0,data:n,loading:u.value,nTableProps:{maxHeight:"calc(100vh - 17rem)"},maxWidth:500,columns:[{title:"任务",key:"name",ellipsis:{tooltip:!0},width:150},{title:"描述",key:"description",width:250,ellipsis:{tooltip:!0}},{title:"状态",key:"status"},{title:"下次执行",key:"",render(t){const a=t.nextDate;return a?f(new Date(a),"MM/dd/yyyy hh:mm:ss"):"N/A"}},{title:"操作",key:"",render(t){return r(k,null,{default:()=>[r(C,{onPositiveClick:()=>void l(t._name,t.name)},{trigger(){return r(T,{size:"tiny",text:!0,type:"success"},{default:()=>[s("执行")]})},default:()=>r("span",{class:"max-w-48"},[s("确定要执行？")])})]})}}]},null)]})}});export{G as default};
