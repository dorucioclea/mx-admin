import{t as y,y as i,H as h,ap as w,a4 as b,M as j,w as x,R as P,K as k,aG as C,J as D}from"./app-c79d7097.js";import{D as E}from"./delete-confirm-568dac89.js";import{R as F}from"./relative-time-0cb5a8b0.js";import{u as R}from"./use-table-17c69ba1.js";import"./guard-ba8a6108.js";import{k as S}from"./use-store-ref-10b7967e.js";import{H as B}from"./rounded-button-f939e53f.js";import{a as M}from"./Checkbox-130849a4.js";import{N as A,a as T}from"./Pagination-b72c8488.js";import{d as U,a as z,ab as I,o as V,b as e,F as q,ac as H,Z as l,ap as K}from"./create-injection-key-6dff4bbb.js";import{N as L,b as _}from"./p-d5bd0779.js";import{N as G,a as O}from"./ListItem-3b929c0f.js";import{Z as u}from"./Card-720de80b.js";import{N as Z}from"./ButtonGroup-229638a3.js";import{N as d}from"./Avatar-bfec934f.js";import"./fade-in.cssr-c6d077ce.js";import"./preload-helper-f651ca80.js";import"./light-4a540c7a.js";import"./Select-a912f9f4.js";import"./light-b93dede2.js";import"./Tag-945120fa.js";import"./_common-991711fd.js";import"./Forward-d74203eb.js";import"./light-758cc2d5.js";import"./prop-8b8caa29.js";import"./light-90743f8c.js";import"./utils-8fb188d9.js";import"./light-9254275d.js";function J(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Object]"&&!K(o)}const Pe=U({setup(){const{data:o,pager:s,sortProps:Q,fetchDataFn:m,loading:f}=R((a,t)=>async(N=p.query.page||1,v=30)=>{const c=await i.api.projects.get({params:{page:N,size:v}});a.value=c.data,t.value=c.pagination}),r=z(new Set),g=y(),p=S(),n=m;return I(()=>p.query.page,async a=>{await n(a)}),V(async()=>{await n()}),()=>e(D,null,{actions:()=>e(q,null,[e(E,{checkedRowKeys:r,onDelete:async()=>{await Promise.all(Array.from(r.values()).map(a=>i.api.projects(a).delete())),r.clear(),n()}},null),e(B,{to:"/projects/edit",icon:e(h,null,null)},null)]),default:()=>e(L,{show:f.value},{default:()=>[e(G,{bordered:!1,class:"min-h-[300px] bg-transparent"},{footer(){return e("div",{class:"flex justify-end"},[e(A,{itemCount:s.value.total,pageCount:s.value.totalPage,page:s.value.currentPage,pageSize:s.value.size,onUpdatePage:a=>{n(a)}},null)])},default(){return o.value.map(a=>e(O,{key:a.id},{prefix(){return e(M,{class:"mt-4",checked:r.has(a.id),onUpdateChecked:t=>{t?r.add(a.id):r.delete(a.id)}},null)},default(){return e(w,{description:a.description},{header(){return e("div",null,[e(u,H({ghost:!0,type:"primary",text:!0,class:"!font-medium"},a.projectUrl?{tag:"a",href:a.projectUrl,target:"_blank"}:{}),{default:()=>[a.name]})])},footer(){return e(b,null,{default:()=>[e(_,{class:"pl-[3.6rem] text-[var(--clear-color-pressed)] text-sm"},{default:()=>[e("span",null,[l("创建于 "),j(a.created)]),a.modified&&e("span",null,[l("更新于")," ",e(F,{time:a.modified},null)])]})]})},"header-extra":function(){return e(Z,null,{default:()=>[e(u,{onClick:()=>{x.push({name:P.EditProject,query:{id:a.id}})}},{default:()=>[l("编辑")]}),e(T,{class:"!p-0",options:[{value:"del",label:"",render(){return e(u,{type:"error",bordered:!1,onClick:async()=>{await i.api.projects(a.id).delete(),g.success("删除成功"),await n(s.value.currentPage)}},{default:()=>[l("删除")]})}}]},{default:()=>[e(u,{class:"!px-2"},{default:()=>[e(k,null,{default:()=>[e(C,null,null)]})]})]})]})},avatar(){let t;return a.avatar?e(d,{class:"align-center",circle:!0,src:a.avatar,size:"large"},null):e(d,{circle:!0,size:"large",class:"align-center"},J(t=a.name[0].toUpperCase())?t:{default:()=>[t]})}})}}))}})]})})}});export{Pe as default};
